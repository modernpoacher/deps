"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.executeEachBundle=executeEachBundle;exports.executeEachOptional=executeEachOptional;exports.executeEachDev=executeEachDev;exports.executeEach=executeEach;exports.executeProd=exports.executeDev=exports.executeOptional=exports.executeBundle=void 0;var _child_process=require("child_process");const transform=v=>Array.isArray(v)?v.map(s=>s.trim().concat('@latest')).join(String.fromCharCode(32)):v.concat('@latest');const installSaveBundle=(d,v,r)=>new Promise((resolve,reject)=>{const commands=['install','--save-bundle',transform(v)].concat(r?['--registry',r]:[]);(0,_child_process.spawn)(`cd "${d}" && npm`,commands,{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveOptional=(d,v,r)=>new Promise((resolve,reject)=>{const commands=['install','--save-optional',transform(v)].concat(r?['--registry',r]:[]);(0,_child_process.spawn)(`cd "${d}" && npm`,commands,{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveDev=(d,v,r)=>new Promise((resolve,reject)=>{const commands=['install','--save-dev',transform(v)].concat(r?['--registry',r]:[]);(0,_child_process.spawn)(`cd "${d}" && npm`,commands,{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveProd=(d,v,r)=>new Promise((resolve,reject)=>{const commands=['install','--save-prod',transform(v)].concat(r?['--registry',r]:[]);(0,_child_process.spawn)(`cd "${d}" && npm`,commands,{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});async function executeEachBundle(dir='.',[key,...array]=[],registry){if(key)await installSaveBundle(dir,key,registry);return array.length?executeEachBundle(dir,array,registry):array;}async function executeEachOptional(dir='.',[key,...array]=[],registry){if(key)await installSaveOptional(dir,key,registry);return array.length?executeEachOptional(dir,array,registry):array;}async function executeEachDev(dir='.',[key,...array]=[],registry){if(key)await installSaveDev(dir,key,registry);return array.length?executeEachDev(dir,array,registry):array;}async function executeEach(dir='.',[key,...array]=[],registry){if(key)await installSaveProd(dir,key,registry);return array.length?executeEach(dir,array,registry):array;}const executeBundle=async(dir='.',dependencies={},registry)=>installSaveBundle(dir,Object.keys(dependencies),registry);exports.executeBundle=executeBundle;const executeOptional=async(dir='.',dependencies={},registry)=>installSaveOptional(dir,Object.keys(dependencies),registry);exports.executeOptional=executeOptional;const executeDev=async(dir='.',dependencies={},registry)=>installSaveDev(dir,Object.keys(dependencies),registry);exports.executeDev=executeDev;const executeProd=async(dir='.',dependencies={},registry)=>installSaveProd(dir,Object.keys(dependencies),registry);exports.executeProd=executeProd;