"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.executeEachBundle=executeEachBundle;exports.executeEachOptional=executeEachOptional;exports.executeEachDev=executeEachDev;exports.executeEach=executeEach;exports.executeProd=exports.executeDev=exports.executeOptional=exports.executeBundle=void 0;var _child_process=require("child_process");const transform=v=>Array.isArray(v)?v.map(s=>s.trim().concat('@latest')).join(String.fromCharCode(32)):v.concat('@latest');const installSaveBundle=(d,v)=>new Promise((resolve,reject)=>{(0,_child_process.spawn)(`cd "${d}" && npm`,['install','--save-bundle',transform(v)],{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveOptional=(d,v)=>new Promise((resolve,reject)=>{(0,_child_process.spawn)(`cd "${d}" && npm`,['install','--save-optional',transform(v)],{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveDev=(d,v)=>new Promise((resolve,reject)=>{(0,_child_process.spawn)(`cd "${d}" && npm`,['install','--save-dev',transform(v)],{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});const installSaveProd=(d,v)=>new Promise((resolve,reject)=>{(0,_child_process.spawn)(`cd "${d}" && npm`,['install','--save-prod',transform(v)],{shell:true,stdio:'inherit'},e=>!e?resolve():reject(e)).on('close',resolve).on('error',reject);});async function executeEachBundle(dir='.',[key,...array]=[]){if(key)await installSaveBundle(dir,key);return array.length?executeEachBundle(dir,array):array;}async function executeEachOptional(dir='.',[key,...array]=[]){if(key)await installSaveOptional(dir,key);return array.length?executeEachOptional(dir,array):array;}async function executeEachDev(dir='.',[key,...array]=[]){if(key)await installSaveDev(dir,key);return array.length?executeEachDev(dir,array):array;}async function executeEach(dir='.',[key,...array]=[]){if(key)await installSaveProd(dir,key);return array.length?executeEach(dir,array):array;}const executeBundle=async(dir='.',dependencies={})=>installSaveBundle(dir,Object.keys(dependencies));exports.executeBundle=executeBundle;const executeOptional=async(dir='.',dependencies={})=>installSaveOptional(dir,Object.keys(dependencies));exports.executeOptional=executeOptional;const executeDev=async(dir='.',dependencies={})=>installSaveDev(dir,Object.keys(dependencies));exports.executeDev=executeDev;const executeProd=async(dir='.',dependencies={})=>installSaveProd(dir,Object.keys(dependencies));exports.executeProd=executeProd;